{"version":3,"sources":["file:///Users/yc/Documents/MahjongDenfense/assets/scripts/Monster.ts"],"names":["UITransform","sp","ccclass","property","cc","_decorator","Monster","Component","spine","onLoad","node","getComponent","Skeleton","setAnimation","console","error","uiTransform","setPosition","winSize","width","Math","random","height","start","update","dt","newX","position","x","speed","y","destroy","playAnimation","animationName","loop"],"mappings":";;;;;;;;;;;;;;;;AACSA,MAAAA,W,OAAAA,W;AAAaC,MAAAA,E,OAAAA,E;;;;;;;OADhB;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBC,EAAE,CAACC,U;;;;yBAIZC,O,GADpBJ,O,qBAAD,MACqBI,OADrB,SACqCF,EAAE,CAACG,SADxC,CACkD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAUtCC,KAVsC,GAUjB,IAViB;AAAA;;AAY9CC,QAAAA,MAAM,GAAG;AACL;AACA,eAAKD,KAAL,GAAa,KAAKE,IAAL,CAAUC,YAAV,CAAuBV,EAAE,CAACW,QAA1B,CAAb;;AACA,cAAI,KAAKJ,KAAT,EAAgB;AACZ;AACA,iBAAKA,KAAL,CAAWK,YAAX,CAAwB,CAAxB,EAA2B,MAA3B,EAAmC,IAAnC;AACH,WAHD,MAGO;AACHC,YAAAA,OAAO,CAACC,KAAR,CAAc,4CAAd;AACH,WARI,CAUL;;;AACA,gBAAMC,WAAW,GAAG,KAAKN,IAAL,CAAUC,YAAV,CAAuBX,WAAvB,CAApB;;AACA,cAAIgB,WAAJ,EAAiB;AACb;AACA,iBAAKN,IAAL,CAAUO,WAAV,CAAsBb,EAAE,CAACc,OAAH,CAAWC,KAAX,GAAmBH,WAAW,CAACG,KAAZ,GAAoB,CAA7D,EAAgEC,IAAI,CAACC,MAAL,KAAgBjB,EAAE,CAACc,OAAH,CAAWI,MAA3B,GAAoClB,EAAE,CAACc,OAAH,CAAWI,MAAX,GAAoB,CAAxH,EAFa,CAGb;AACH,WAJD,MAIO;AACHR,YAAAA,OAAO,CAACC,KAAR,CAAc,kDAAd;AACH;AAGJ;;AAEDQ,QAAAA,KAAK,GAAG,CACJ;AACH;;AAEDC,QAAAA,MAAM,CAACC,EAAD,EAAK;AACP,gBAAMT,WAAW,GAAG,KAAKN,IAAL,CAAUC,YAAV,CAAuBX,WAAvB,CAApB;;AACA,cAAI,CAACgB,WAAL,EAAkB;AACdF,YAAAA,OAAO,CAACC,KAAR,CAAc,kDAAd;AACA;AACH,WALM,CAOP;AACA;AAEA;;;AACA,gBAAMW,IAAI,GAAG,KAAKhB,IAAL,CAAUiB,QAAV,CAAmBC,CAAnB,GAAuB,KAAKC,KAAL,GAAaJ,EAAjD;AACA,eAAKf,IAAL,CAAUO,WAAV,CAAsBS,IAAtB,EAA4B,KAAKhB,IAAL,CAAUiB,QAAV,CAAmBG,CAA/C,EAZO,CAcP;AACA;AAEA;;AACA,cAAI,KAAKpB,IAAL,CAAUiB,QAAV,CAAmBC,CAAnB,GAAuB,CAACxB,EAAE,CAACc,OAAH,CAAWC,KAAZ,GAAoB,CAApB,GAAwBH,WAAW,CAACG,KAAZ,GAAoB,CAAvE,EAA0E;AACtE,iBAAKT,IAAL,CAAUqB,OAAV,GADsE,CAEtE;AACH;AACJ;;AAEDC,QAAAA,aAAa,CAACC,aAAD,EAAwBC,IAAxB,EAAuC;AAChD,cAAI,KAAK1B,KAAT,EAAgB;AACZ,iBAAKA,KAAL,CAAWK,YAAX,CAAwB,CAAxB,EAA2BoB,aAA3B,EAA0CC,IAA1C;AACH;AACJ;;AAnE6C,O,qEAC7C/B,Q;;;;;iBACY,G;;gFAEZA,Q;;;;;iBACe,G;;iFAEfA,Q;;;;;iBACgB,E","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport { UITransform, sp } from 'cc';\n\n@ccclass\nexport default class Monster extends cc.Component {\n    @property\n    hp: number = 100;\n\n    @property\n    speed: number = 100;\n\n    @property\n    attack: number = 10;\n\n    private spine: sp.Skeleton = null;\n\n    onLoad() {\n        // 获取 Spine 组件\n        this.spine = this.node.getComponent(sp.Skeleton);\n        if (this.spine) {\n            // 设置默认动画\n            this.spine.setAnimation(0, 'IDLE', true);\n        } else {\n            console.error('Spine component not found on monster node.');\n        }\n\n        // 获取UITransform组件\n        const uiTransform = this.node.getComponent(UITransform);\n        if (uiTransform) {\n            // 设置怪物在屏幕最右侧生成\n            this.node.setPosition(cc.winSize.width + uiTransform.width / 2, Math.random() * cc.winSize.height - cc.winSize.height / 2);\n            // console.log(`Monster created at position: ${this.node.position}`);\n        } else {\n            console.error('UITransform component not found on monster node.');\n        }\n\n        \n    }\n\n    start() {\n        // console.log(`Monster start method called.`);\n    }\n\n    update(dt) {\n        const uiTransform = this.node.getComponent(UITransform);\n        if (!uiTransform) {\n            console.error('UITransform component not found on monster node.');\n            return;\n        }\n\n        // 确保 update() 方法被调用\n        // console.log(`Monster is updating. dt=${dt}, speed=${this.speed}, current position: (${this.node.position.x}, ${this.node.position.y})`);\n        \n        // 让怪物向左移动\n        const newX = this.node.position.x - this.speed * dt;\n        this.node.setPosition(newX, this.node.position.y);\n        \n        // 确保位置更新\n        // console.log(`Monster new position: (${this.node.position.x}, ${this.node.position.y})`);\n        \n        // 如果怪物移出屏幕左侧，则销毁该节点\n        if (this.node.position.x < -cc.winSize.width / 2 - uiTransform.width / 2) {\n            this.node.destroy();\n            // console.log(`Monster destroyed.`);\n        }\n    }\n\n    playAnimation(animationName: string, loop: boolean) {\n        if (this.spine) {\n            this.spine.setAnimation(0, animationName, loop);\n        }\n    }\n}"]}