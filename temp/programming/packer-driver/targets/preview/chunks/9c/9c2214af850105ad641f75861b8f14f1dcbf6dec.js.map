{"version":3,"sources":["file:///C:/Users/Administrator/MiaoMiaoMaJiang/assets/extensions/mahjong_generators.ts"],"names":["Node","Prefab","Sprite","SpriteFrame","EDITOR","EditorExtends","Menu","Path","addMenuItem","generateMahjongPrefabs","config","basePath","faceDir","outputDir","types","numbers","Array","from","length","_","i","baseSpriteFrame","AssetDB","loadAsset","type","number","facePath","faceSpriteFrame","prefabNode","baseNode","baseSprite","addComponent","spriteFrame","sizeMode","SizeMode","TRIMMED","addChild","faceNode","faceSprite","setPosition","prefab","data","outputPath","createOrSaveAsset","Dialog","info"],"mappings":"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","sourcesContent":["import { EDITOR } from 'cc/env';\r\nimport { director } from 'cc';\r\nimport { Asset, Node, Prefab, Sprite, SpriteFrame, _decorator } from 'cc';\r\nimport * as EditorExtends from 'editor-extends';\r\n\r\nif (EDITOR) {\r\n  const { Menu, Path } = EditorExtends;\r\n\r\n  // 注册到编辑器菜单\r\n  Menu.addMenuItem('Project/生成麻将Prefab', async () => {\r\n    await generateMahjongPrefabs();\r\n  });\r\n\r\n  async function generateMahjongPrefabs() {\r\n    // 配置参数\r\n    const config = {\r\n      basePath: 'Miaojiang/miaojiang_bai',   // 底图路径\r\n      faceDir: 'Tiles',                      // 牌面目录\r\n      outputDir: 'Prefabs/Mahjong',          // 输出目录\r\n      types: ['wan', 'tong', 'tiao', 'feng', 'jian'], // 麻将类型\r\n      numbers: Array.from({ length: 9 }, (_, i) => i + 1) // 数字1-9\r\n    };\r\n\r\n    // 加载底图资源\r\n    const baseSpriteFrame = await EditorExtends.AssetDB.loadAsset(\r\n      `db://assets/${config.basePath}.png`, \r\n      SpriteFrame\r\n    ) as SpriteFrame;\r\n\r\n    // 遍历所有牌型组合\r\n    for (const type of config.types) {\r\n      for (const number of config.numbers) {\r\n        const facePath = `${config.faceDir}/mj_${type}_${number}`;\r\n        \r\n        // 加载牌面资源\r\n        const faceSpriteFrame = await EditorExtends.AssetDB.loadAsset(\r\n          `db://assets/${facePath}.png`,\r\n          SpriteFrame\r\n        ) as SpriteFrame;\r\n\r\n        // 创建预制体节点\r\n        const prefabNode = new Node(`Mahjong_${type}_${number}`);\r\n        \r\n        // 添加底图组件\r\n        const baseNode = new Node('Base');\r\n        const baseSprite = baseNode.addComponent(Sprite);\r\n        baseSprite.spriteFrame = baseSpriteFrame;\r\n        baseSprite.sizeMode = Sprite.SizeMode.TRIMMED;\r\n        prefabNode.addChild(baseNode);\r\n\r\n        // 添加牌面组件\r\n        const faceNode = new Node('Face');\r\n        const faceSprite = faceNode.addComponent(Sprite);\r\n        faceSprite.spriteFrame = faceSpriteFrame;\r\n        faceNode.setPosition(0, 10); // 微调牌面位置\r\n        prefabNode.addChild(faceNode);\r\n\r\n        // 生成Prefab并保存\r\n        const prefab = new Prefab();\r\n        prefab.data = prefabNode;\r\n        const outputPath = `${config.outputDir}/mahjong_${type}_${number}.prefab`;\r\n        await EditorExtends.AssetDB.createOrSaveAsset(\r\n          prefab, \r\n          `db://assets/${outputPath}`\r\n        );\r\n      }\r\n    }\r\n\r\n    EditorExtends.Dialog.info('生成完成', `已创建${config.types.length * config.numbers.length}个Prefab`);\r\n  }\r\n}"]}